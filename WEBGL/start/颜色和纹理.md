# 颜色与纹理

为顶点的每一个数据建立一个缓冲区，然后分配给对应的attribute变量，你可以向顶点着色器传递多份顶点数据。如：顶点尺寸，顶点坐标，顶点颜色，顶点纹理，法向量等。
其中使用多个缓冲区向着色器传递多种数据，比较适合数据里不大的情况。当程序有上万个顶点的时候显然不行。所以我们将顶点数据打包放到同一缓冲区里面，通过某种机制分别访问缓冲区对象中的不同种类数据。例如以交错组织的方式来放数据：

```js
var verticesSizes = new Float32Array([
    // 顶点坐标与点尺寸
    0.0, 0.5, 10.0, // 第一个点
    -0.5, -0.5, 20.0, // 第二个点
    0.5, -0.5, 30.0 // 第三个点
]) 
```

## WebGLRenderingContext.vertexAttribPointer()
将绑定到gl.ARRAY_BUFFE的缓冲区对象分配到由location指定的attribute变量
```js
/*
index 指定要修改的顶点属性的索引。

size 指定每个顶点属性的组成数量，必须是 1，2，3 或 4。

type 指定数组中每个元素的数据类型可能是：
    gl.BYTE: signed 8-bit integer, with values in [-128, 127] 有符号的 8 位整数，范围 [-128, 127]
    gl.SHORT: signed 16-bit integer, with values in [-32768, 32767] 有符号的 16 位整数，范围 [-32768, 32767]
    gl.UNSIGNED_BYTE: unsigned 8-bit integer, with values in [0, 255] 无符号的 8 位整数，范围 [0, 255]
    gl.UNSIGNED_SHORT: unsigned 16-bit integer, with values in [0, 65535] 无符号的 16 位整数，范围 [0, 65535]
    gl.FLOAT: 32-bit IEEE floating point number 32 位 IEEE 标准的浮点数
    When using a WebGL 2 context, the following values are available additionally: 使用 WebGL2 版本的还可以使用以下值：
    gl.HALF_FLOAT: 16-bit IEEE floating point number 16 位 IEEE 标准的浮点数

normalized 转换为浮点数时是否应该将整数数值归一化到特定的范围[0, 1] [-1, 1]。

stride 指定相邻两个顶点间的字节数，默认0

offset 指定缓冲区对象中的偏移量（以字节为单位），即attribute变量从缓冲区的何处开始存储。如果是从起始位置开始，参数设置为0

Return value
None.
*/
void gl.vertexAttribPointer(index, size, type, normalized, stride, offset);
```

## varying变量

varying是WebGL中的一个关键字，用于在顶点着色器和片元着色器之间传递数据。在WebGL中，顶点着色器对每个顶点进行计算，并输出新的顶点位置、法向量等信息。然后，这些信息会传递给片元着色器，片元着色器使用这些信息对每个片元进行计算，并输出最终的颜色值。在顶点着色器和片元着色器之间传递数据的方式就是使用varying关键字声明变量。

例如，如果要在顶点着色器和片元着色器之间传递顶点的颜色信息，可以在顶点着色器中声明一个varying变量，然后在片元着色器中使用这个变量。具体的代码可以是这样的：

```js
// 顶点着色器
attribute vec3 position; // 顶点坐标
attribute vec3 color; // 顶点颜色

varying vec3 vColor; // 传递到片元着色器的变量

void main() {
  vColor = color; // 把顶点颜色传递给vColor变量
  gl_Position = vec4(position, 1.0); // 输出顶点位置
}

// 片元着色器
precision mediump float;

varying vec3 vColor; // 接收从顶点着色器传递过来的变量

void main() {
  gl_FragColor = vec4(vColor, 1.0); // 输出片元颜色
}
```
在上面这个例子中，声明**attribute vec3 color**来接收传入的数据，而**varying vec3 vColor**负责将颜色传给片元着色器。注意**varying**只能是**float vec2 vec3 vec4 mat2 mat3 mat4**类型。在片元着色器声明同样的**varying**变量即可。在webGL中如果顶点着色器与片元着色器有相同类型和命名相同的varying变量，那么顶点着色器复制给该变量的值会自动传入片元着色器。