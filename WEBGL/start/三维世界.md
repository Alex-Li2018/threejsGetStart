# 三维世界
3D世界中，在计算各个物体位置的时候是以世界坐标为主的，但是最终却是所有3D模型都需要转换到视野空间中的（view space），这样才能在屏幕中显示出来。
## 概念

- 视点：观察者所处的位置 （eyeX, eyeY, eyeZ）
- 视线：从视点出发沿着观察方向的射线
- 观察目标点：被观察目标所在点，可以用来确定视线 (atX, atY, atZ)
- 上方向：最终绘制在屏幕上的影像中的向上的方向，如果观察者头部偏移那么景象也会偏移，那么上方向就会固定住观察者。(upX, upY, upZ)

## 视野矩阵

在WebGL中，视图矩阵（View Matrix）用于描述相机的位置和朝向，是将场景从世界坐标系变换到相机坐标系的矩阵。它通常被称为观察矩阵（Viewing Matrix），因为它用于模拟相机从某个角度观察场景。
视图矩阵通常由相机的位置、朝向和上方向（也称为“头顶朝向”）组成。其中位置是指相机的位置，朝向是指相机所看方向的向量，上方向是指相机顶部的方向。
WebGL中的视图矩阵可以通过以下步骤来构建：
- 确定相机的位置、朝向和上方向。
- 根据相机位置和朝向，计算相机的右向量和视线向量。其中，相机的右向量可以通过叉乘计算相机朝向和上方向的向量得到，视线向量可以通过将相机位置减去朝向向量得到。
- 将相机的右向量、上方向和视线向量组成一个3x3的矩阵，得到相机坐标系下的基向量矩阵。
- 将相机位置的相反数乘以基向量矩阵，得到最终的视图矩阵。

实际应用中，可以使用现有的矩阵库（如gl-matrix）来构建视图矩阵，以简化计算过程。

### 视野矩阵的推导





## 模型矩阵 model matrix 
平移旋转缩放的基本矩阵以及它们的复合矩阵，这种叫着模型矩阵。

<变换后的顶点> = <模型矩阵><原始的顶点>

## 模型视野矩阵 model view matrix

<模型视图矩阵> = <视图矩阵><模型矩阵>

推导：
<从视点看上去的变换矩阵>=<视图矩阵><旋转矩阵><原始顶点>

## 可视范围

人类只能看到眼前的东西，水平视角大约200度。总之，WebGL就是以类似的方式，只绘制可视范围内的三维对象。
- 长方体可视空间，也称盒装空间，由正射投影产生。场景中物体的大小与所在位置无关，建筑上使用。
- 四棱锥/金字塔可是空间，由透视投影产生。画面有深度层机感。射击游戏。

### 正射投影

![正射投影](./imgs/%E6%AD%A3%E5%B0%84%E6%8A%95%E5%BD%B1.png)

x轴向右为正，y轴向上为正，z轴屏幕向里为正

- 近裁切面 (right, top, -near) (-left, top, -near) (-left, -bottom, -near) (right, -bottom, -near)
- 远裁切面 (right, top, far) (-left, top, far) (-left, -bottom, far) (right, -bottom, far)

如果某个物体一部分在可视范围内，一部分在可视范围外。那么在可视范围外的不可见。

### 透视投影

![透视投影](./imgs/%E9%80%8F%E8%A7%86%E6%8A%95%E5%BD%B1.png)


